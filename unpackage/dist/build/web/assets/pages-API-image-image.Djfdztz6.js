import{aq as e,P as s,b0 as a,m as l,p as t,q as i,A as n,o as u,s as c,j as o,t as r,d,f as p,F as f,ah as g,af as h,x as m}from"./index-DQotwNSd.js";import{_}from"./page-head.CAicG8M0.js";import{r as y}from"./uni-app.es.Dfk47BXh.js";import{p as I}from"./permission.CmydlN9K.js";import{_ as T}from"./_plugin-vue_export-helper.BCo6x5W8.js";var x=[["camera"],["album"],["camera","album"]],C=[["compressed"],["original"],["compressed","original"]];const v=T({data:()=>({title:"choose/previewImage",imageList:[],sourceTypeIndex:2,sourceType:["拍照","相册","拍照或相册"],sizeTypeIndex:2,sizeType:["压缩","原图","压缩或原图"],countIndex:8,count:[1,2,3,4,5,6,7,8,9]}),onUnload(){this.imageList=[],this.sourceTypeIndex=2,this.sourceType=["拍照","相册","拍照或相册"],this.sizeTypeIndex=2,this.sizeType=["压缩","原图","压缩或原图"],this.countIndex=8},methods:{sourceTypeChange:function(e){this.sourceTypeIndex=parseInt(e.detail.value)},sizeTypeChange:function(e){this.sizeTypeIndex=parseInt(e.detail.value)},countChange:function(e){this.countIndex=e.detail.value},chooseImage:async function(){if(9===this.imageList.length){let e=await this.isFullImg();if(console.log("是否继续?",e),!e)return}e({sourceType:x[this.sourceTypeIndex],sizeType:C[this.sizeTypeIndex],count:this.imageList.length+this.count[this.countIndex]>9?9-this.imageList.length:this.count[this.countIndex],success:e=>{this.imageList=this.imageList.concat(e.tempFilePaths)},fail:e=>{console.log("err: ",e)}})},isFullImg:function(){return new Promise((e=>{s({content:"已经有9张图片了,是否清空现有图片？",success:s=>{s.confirm?(this.imageList=[],e(!0)):e(!1)},fail:()=>{e(!1)}})}))},previewImage:function(e){var s=e.target.dataset.src;a({current:s,urls:this.imageList})},async checkPermission(e){let a=e?e-1:this.sourceTypeIndex,l=I.isIOS?await I.requestIOS(x[a][0]):await I.requestAndroid(0===a?"android.permission.CAMERA":"android.permission.READ_EXTERNAL_STORAGE");return null===l||1===l?l=1:s({content:"没有开启权限",confirmText:"设置",success:function(e){e.confirm&&I.gotoAppSetting()}}),l}}},[["render",function(e,s,a,I,T,x){const C=y(l("page-head"),_),v=n,z=g,L=m,b=h;return u(),t(v,null,{default:i((()=>[c(C,{title:T.title},null,8,["title"]),c(v,{class:"uni-common-mt"},{default:i((()=>[c(b,null,{default:i((()=>[c(v,{class:"uni-list"},{default:i((()=>[c(v,{class:"uni-list-cell"},{default:i((()=>[c(v,{class:"uni-list-cell-left"},{default:i((()=>[c(v,{class:"uni-label"},{default:i((()=>[o("图片来源")])),_:1})])),_:1}),c(v,{class:"uni-list-cell-right"},{default:i((()=>[c(z,{range:T.sourceType,onChange:x.sourceTypeChange,value:T.sourceTypeIndex,mode:"selector"},{default:i((()=>[c(v,{class:"uni-input"},{default:i((()=>[o(r(T.sourceType[T.sourceTypeIndex]),1)])),_:1})])),_:1},8,["range","onChange","value"])])),_:1})])),_:1}),c(v,{class:"uni-list-cell"},{default:i((()=>[c(v,{class:"uni-list-cell-left"},{default:i((()=>[c(v,{class:"uni-label"},{default:i((()=>[o("图片质量")])),_:1})])),_:1}),c(v,{class:"uni-list-cell-right"},{default:i((()=>[c(z,{range:T.sizeType,onChange:x.sizeTypeChange,value:T.sizeTypeIndex,mode:"selector"},{default:i((()=>[c(v,{class:"uni-input"},{default:i((()=>[o(r(T.sizeType[T.sizeTypeIndex]),1)])),_:1})])),_:1},8,["range","onChange","value"])])),_:1})])),_:1}),c(v,{class:"uni-list-cell"},{default:i((()=>[c(v,{class:"uni-list-cell-left"},{default:i((()=>[c(v,{class:"uni-label"},{default:i((()=>[o("数量限制")])),_:1})])),_:1}),c(v,{class:"uni-list-cell-right"},{default:i((()=>[c(z,{range:T.count,onChange:x.countChange,mode:"selector"},{default:i((()=>[c(v,{class:"uni-input"},{default:i((()=>[o(r(T.count[T.countIndex]),1)])),_:1})])),_:1},8,["range","onChange"])])),_:1})])),_:1})])),_:1}),c(v,{class:"uni-list list-pd"},{default:i((()=>[c(v,{class:"uni-list-cell cell-pd"},{default:i((()=>[c(v,{class:"uni-uploader"},{default:i((()=>[c(v,{class:"uni-uploader-head"},{default:i((()=>[c(v,{class:"uni-uploader-title"},{default:i((()=>[o("点击可预览选好的图片")])),_:1}),c(v,{class:"uni-uploader-info"},{default:i((()=>[o(r(T.imageList.length)+"/9",1)])),_:1})])),_:1}),c(v,{class:"uni-uploader-body"},{default:i((()=>[c(v,{class:"uni-uploader__files"},{default:i((()=>[(u(!0),d(f,null,p(T.imageList,((e,s)=>(u(),t(v,{key:s,class:"uni-uploader__file"},{default:i((()=>[c(L,{class:"uni-uploader__img",src:e,"data-src":e,onClick:x.previewImage},null,8,["src","data-src","onClick"])])),_:2},1024)))),128)),c(v,{class:"uni-uploader__input-box"},{default:i((()=>[c(v,{class:"uni-uploader__input",onClick:x.chooseImage},null,8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-bd82ad51"]]);export{v as default};
