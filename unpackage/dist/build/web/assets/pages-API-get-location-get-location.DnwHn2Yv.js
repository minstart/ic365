import{b7 as t,I as e,P as o,m as i,p as n,q as s,A as a,o as u,s as l,j as c,h as p,t as r,y as d,K as f}from"./index-DQotwNSd.js";import{_ as m}from"./page-head.CAicG8M0.js";import{r as h}from"./uni-app.es.Dfk47BXh.js";import{_ as g}from"./uni-popup.jkbdaXzd.js";import{a as _}from"./util.BQsFLuvY.js";import{_ as y}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-transition.CMQQwnrp.js";var C=_;const L=y({data:()=>({title:"getLocation",hasLocation:!1,location:{},type:""}),methods:{togglePopup(t){this.type=t},showConfirm(){this.type="showpopup"},hideConfirm(){this.type=""},async getLocation(){this.doGetLocation()},doGetLocation(){t({success:t=>{this.hasLocation=!0,this.location=C(t.longitude,t.latitude)},fail:t=>{t.errMsg.indexOf("auth deny")>=0?e({title:"访问位置被拒绝"}):e({title:t.errMsg})}})},getSetting:function(){return new Promise(((t,e)=>{uni.getSetting({success:e=>{void 0!==e.authSetting["scope.userLocation"]?e.authSetting["scope.userLocation"]?t(1):t(2):t(0)}})}))},openSetting:function(){this.hideConfirm(),uni.openSetting({success:t=>{t.authSetting&&t.authSetting["scope.userLocation"]&&this.doGetLocation()},fail:t=>{}})},async checkPermission(){let t=permision.isIOS?await permision.requestIOS("location"):await permision.requestAndroid("android.permission.ACCESS_FINE_LOCATION");return null===t||1===t?t=1:2===t?o({content:"系统定位已关闭",confirmText:"确定",showCancel:!1,success:function(t){}}):t.code?o({content:t.message}):o({content:"需要定位权限",confirmText:"设置",success:function(t){t.confirm&&permision.gotoAppSetting()}}),t},clear:function(){this.hasLocation=!1}}},[["render",function(t,e,o,_,y,C){const L=h(i("page-head"),m),S=a,x=d,k=f,w=h(i("uni-popup"),g);return u(),n(S,null,{default:s((()=>[l(L,{title:y.title},null,8,["title"]),l(S,{class:"uni-padding-wrap"},{default:s((()=>[l(S,{style:{background:"#FFFFFF",padding:"40rpx"}},{default:s((()=>[l(S,{class:"uni-hello-text uni-center"},{default:s((()=>[c("当前位置经纬度")])),_:1}),!1===y.hasLocation?(u(),n(S,{key:0,class:"uni-h2 uni-center uni-common-mt"},{default:s((()=>[c("未获取")])),_:1})):p("",!0),!0===y.hasLocation?(u(),n(S,{key:1,class:"uni-h2 uni-center uni-common-mt"},{default:s((()=>[l(x,null,{default:s((()=>[c("E: "+r(y.location.longitude[0])+"°"+r(y.location.longitude[1])+"′",1)])),_:1}),l(x,null,{default:s((()=>[c("\\nN: "+r(y.location.latitude[0])+"°"+r(y.location.latitude[1])+"′",1)])),_:1})])),_:1})):p("",!0)])),_:1}),l(S,{class:"uni-btn-v"},{default:s((()=>[l(k,{type:"primary",onClick:C.getLocation},{default:s((()=>[c("获取位置")])),_:1},8,["onClick"]),l(k,{onClick:C.clear},{default:s((()=>[c("清空")])),_:1},8,["onClick"])])),_:1})])),_:1}),l(w,{show:"showpopup"===y.type,mode:"fixed",onHidePopup:e[1]||(e[1]=t=>C.togglePopup(""))},{default:s((()=>[l(S,{class:"popup-view"},{default:s((()=>[l(x,{class:"popup-title"},{default:s((()=>[c("需要用户授权位置权限")])),_:1}),l(S,{class:"uni-flex popup-buttons"},{default:s((()=>[l(k,{class:"uni-flex-item",type:"primary","open-type":"openSetting",onClick:C.openSetting},{default:s((()=>[c("设置")])),_:1},8,["onClick"]),l(k,{class:"uni-flex-item",onClick:e[0]||(e[0]=t=>C.togglePopup(""))},{default:s((()=>[c("取消")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])])),_:1})}],["__scopeId","data-v-b6792ebc"]]);export{L as default};
