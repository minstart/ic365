import{M as t,aI as a,G as e,m as s,p as i,q as l,A as n,o,s as d,j as r,t as u,d as c,f as h,F as m,x as _,y as p}from"./index-DQotwNSd.js";import{_ as f}from"./uni-load-more.hs90foDd.js";import{r as g}from"./uni-app.es.Dfk47BXh.js";import{d as b}from"./util.BQsFLuvY.js";import{_ as v}from"./_plugin-vue_export-helper.BCo6x5W8.js";const x=v({data:()=>({banner:{},listData:[],last_id:"",reload:!1,status:"more",adpid:"",contentText:{contentdown:"上拉加载更多",contentrefresh:"加载中",contentnomore:"没有更多"}}),onLoad(){this.adpid=this.$adpid,this.getBanner(),this.getList()},onPullDownRefresh(){this.reload=!0,this.last_id="",this.getBanner(),this.getList()},onReachBottom(){this.status="more",this.getList()},methods:{getBanner(){t({url:"https://unidemo.dcloud.net.cn/api/banner/36kr",data:{column:"id,post_id,title,author_name,cover,published_at"},success:t=>{a(),200==t.statusCode&&(this.banner=t.data)},fail:(t,a)=>{console.log("fail"+JSON.stringify(t))}})},getList(){var a={column:"id,post_id,title,author_name,cover,published_at"};this.last_id&&(this.status="loading",a.minId=this.last_id,a.time=(new Date).getTime()+"",a.pageSize=10),t({url:"https://unidemo.dcloud.net.cn/api/news",data:a,success:t=>{if(200==t.statusCode){let a=this.setTime(t.data);this.listData=this.reload?a:this.listData.concat(a),this.last_id=a[a.length-1].id,this.reload=!1}},fail:(t,a)=>{console.log("fail"+JSON.stringify(t))}})},goDetail:function(t){let a={author_name:t.author_name,cover:t.cover,id:t.id,post_id:t.post_id,published_at:t.published_at,title:t.title};e({url:"../list2detail-detail/list2detail-detail?detailDate="+encodeURIComponent(JSON.stringify(a))})},setTime:function(t){var a=[];return t.forEach((t=>{a.push({author_name:t.author_name,cover:t.cover,id:t.id,post_id:t.post_id,published_at:b.format(t.published_at),title:t.title})})),a},aderror(t){console.log("aderror: "+JSON.stringify(t.detail))}}},[["render",function(t,a,e,b,v,x){const D=_,y=n,j=p,C=g(s("uni-load-more"),f);return o(),i(y,null,{default:l((()=>[d(y,{class:"banner",onClick:a[0]||(a[0]=t=>x.goDetail(v.banner))},{default:l((()=>[d(D,{class:"banner-img",src:v.banner.cover},null,8,["src"]),d(y,{class:"banner-title"},{default:l((()=>[r(u(v.banner.title),1)])),_:1})])),_:1}),d(y,{class:"uni-list"},{default:l((()=>[(o(!0),c(m,null,h(v.listData,((t,a)=>(o(),i(y,{key:a,class:"uni-list-cell","hover-class":"uni-list-cell-hover",onClick:a=>x.goDetail(t)},{default:l((()=>[d(y,{class:"uni-media-list"},{default:l((()=>[d(D,{class:"uni-media-list-logo",src:t.cover},null,8,["src"]),d(y,{class:"uni-media-list-body"},{default:l((()=>[d(y,{class:"uni-media-list-text-top"},{default:l((()=>[r(u(t.title),1)])),_:2},1024),d(y,{class:"uni-media-list-text-bottom"},{default:l((()=>[d(j,null,{default:l((()=>[r(u(t.author_name),1)])),_:2},1024),d(j,null,{default:l((()=>[r(u(t.published_at),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),d(C,{status:v.status,"icon-size":16,"content-text":v.contentText},null,8,["status","content-text"])])),_:1})}],["__scopeId","data-v-6761830d"]]);export{x as default};
