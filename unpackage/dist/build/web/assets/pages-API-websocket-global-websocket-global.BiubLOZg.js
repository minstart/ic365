import{k as s,be as e,N as o,P as t,L as n,bd as a,bf as c,I as l,bg as i,bh as r,bi as d,bj as g,m as p,p as h,q as m,A as u,o as f,s as b,j as k,t as _,b as w,v as C,K as y}from"./index-DQotwNSd.js";import{_ as j}from"./page-head.CAicG8M0.js";import{r as v}from"./uni-app.es.Dfk47BXh.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";let I=s().platform;const M=x({data:()=>({connected:!1,connecting:!1,msg:!1,roomId:""}),computed:{showMsg(){return this.connected?this.msg?"收到消息："+this.msg:"等待接收消息":"尚未连接"}},onUnload(){e(),o()},methods:{connect(){if(this.connected||this.connecting)return t({content:"正在连接或者已经连接，请勿重复连接",showCancel:!1}),!1;this.connecting=!0,n({title:"连接中..."}),a({url:"wss://echo.websocket.org",data:()=>({msg:"Hello"}),success(s){},fail(s){}}),c((s=>{this.connecting=!1,this.connected=!0,o(),l({icon:"none",title:"连接成功"}),console.log("onOpen",s)})),i((s=>{this.connecting=!1,this.connected=!1,o(),t({content:"连接失败，可能是websocket服务不可用，请稍后再试",showCancel:!1}),console.log("onError",s)})),r((s=>{this.msg=s.data,console.log("onMessage",s)})),d((s=>{this.connected=!1,this.startRecive=!1,this.msg=!1,console.log("onClose",s)}))},send(){g({data:"from "+I+" : "+parseInt(1e4*Math.random()).toString(),success(s){console.log(s)},fail(s){console.log(s)}})},close(){e()}}},[["render",function(s,e,o,t,n,a){const c=v(p("page-head"),j),l=u,i=y;return f(),h(l,null,{default:m((()=>[b(c,{title:"websocket通讯示例"}),b(l,{class:"uni-padding-wrap"},{default:m((()=>[b(l,{class:"uni-btn-v"},{default:m((()=>[b(l,{class:"websocket-msg"},{default:m((()=>[k(_(a.showMsg),1)])),_:1}),b(i,{type:"primary",onClick:a.connect},{default:m((()=>[k("连接websocket服务")])),_:1},8,["onClick"]),w(b(i,{type:"primary",onClick:a.send},{default:m((()=>[k("发送一条消息")])),_:1},8,["onClick"]),[[C,n.connected]]),b(i,{type:"primary",onClick:a.close},{default:m((()=>[k("断开websocket服务")])),_:1},8,["onClick"]),b(l,{class:"websocket-tips"},{default:m((()=>[k("发送消息后会收到一条服务器返回的消息（与发送的消息内容一致）")])),_:1})])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-36334d31"]]);export{M as default};
