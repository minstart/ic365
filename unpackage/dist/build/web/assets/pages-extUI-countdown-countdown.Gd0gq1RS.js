import{bm as t,o as e,p as o,q as n,i as s,j as i,t as u,h as a,s as l,y as d,A as r,I as h,m as c}from"./index-DQotwNSd.js";import{_ as m}from"./uni-card.DtmtsBix.js";import{r as p}from"./uni-app.es.Dfk47BXh.js";import{_ as y}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as f}from"./uni-section.DD6p8Tlx.js";const w={en:{"uni-countdown.day":"day","uni-countdown.h":"h","uni-countdown.m":"m","uni-countdown.s":"s"},"zh-Hans":{"uni-countdown.day":"天","uni-countdown.h":"时","uni-countdown.m":"分","uni-countdown.s":"秒"},"zh-Hant":{"uni-countdown.day":"天","uni-countdown.h":"時","uni-countdown.m":"分","uni-countdown.s":"秒"}},{t:S}=t(w);const _=y({name:"UniCountdown",emits:["timeup"],props:{showDay:{type:Boolean,default:!0},showHour:{type:Boolean,default:!0},showMinute:{type:Boolean,default:!0},showColon:{type:Boolean,default:!0},start:{type:Boolean,default:!0},backgroundColor:{type:String,default:""},color:{type:String,default:"#333"},fontSize:{type:Number,default:14},splitorColor:{type:String,default:"#333"},day:{type:Number,default:0},hour:{type:Number,default:0},minute:{type:Number,default:0},second:{type:Number,default:0},timestamp:{type:Number,default:0},filterShow:{type:Object,default:{}}},data:()=>({timer:null,syncFlag:!1,d:"00",h:"00",i:"00",s:"00",leftTime:0,seconds:0}),computed:{dayText:()=>S("uni-countdown.day"),hourText:t=>S("uni-countdown.h"),minuteText:t=>S("uni-countdown.m"),secondText:t=>S("uni-countdown.s"),timeStyle(){const{color:t,backgroundColor:e,fontSize:o}=this;return{color:t,backgroundColor:e,fontSize:`${o}px`,width:22*o/14+"px",lineHeight:20*o/14+"px",borderRadius:3*o/14+"px"}},splitorStyle(){const{splitorColor:t,fontSize:e,backgroundColor:o}=this;return{color:t,fontSize:12*e/14+"px",margin:o?4*e/14+"px":""}}},watch:{day(t){this.changeFlag()},hour(t){this.changeFlag()},minute(t){this.changeFlag()},second(t){this.changeFlag()},start:{immediate:!0,handler(t,e){if(t)this.startData();else{if(!e)return;clearInterval(this.timer)}}}},created:function(t){this.seconds=this.toSeconds(this.timestamp,this.day,this.hour,this.minute,this.second),this.countDown()},unmounted(){clearInterval(this.timer)},methods:{toSeconds:(t,e,o,n,s)=>t?t-parseInt((new Date).getTime()/1e3,10):60*e*60*24+60*o*60+60*n+s,timeUp(){clearInterval(this.timer),this.$emit("timeup")},countDown(){let t=this.seconds,[e,o,n,s]=[0,0,0,0];t>0?(e=Math.floor(t/86400),o=Math.floor(t/3600)-24*e,n=Math.floor(t/60)-24*e*60-60*o,s=Math.floor(t)-24*e*60*60-60*o*60-60*n):this.timeUp(),this.d=String(e).padStart(this.validFilterShow(this.filterShow.d),"0"),this.h=String(o).padStart(this.validFilterShow(this.filterShow.h),"0"),this.i=String(n).padStart(this.validFilterShow(this.filterShow.m),"0"),this.s=String(s).padStart(this.validFilterShow(this.filterShow.s),"0")},validFilterShow:t=>t&&t>0?t:2,startData(){if(this.seconds=this.toSeconds(this.timestamp,this.day,this.hour,this.minute,this.second),this.seconds<=0)return this.seconds=this.toSeconds(0,0,0,0,0),void this.countDown();clearInterval(this.timer),this.countDown(),this.timer=setInterval((()=>{this.seconds--,this.seconds<0?this.timeUp():this.countDown()}),1e3)},update(){this.startData()},changeFlag(){this.syncFlag||(this.seconds=this.toSeconds(this.timestamp,this.day,this.hour,this.minute,this.second),this.startData(),this.syncFlag=!0)}}},[["render",function(t,h,c,m,p,y){const f=d,w=r;return e(),o(w,{class:"uni-countdown"},{default:n((()=>[c.showDay?(e(),o(f,{key:0,style:s([y.timeStyle]),class:"uni-countdown__number"},{default:n((()=>[i(u(p.d),1)])),_:1},8,["style"])):a("",!0),c.showDay?(e(),o(f,{key:1,style:s([y.splitorStyle]),class:"uni-countdown__splitor"},{default:n((()=>[i(u(y.dayText),1)])),_:1},8,["style"])):a("",!0),c.showHour?(e(),o(f,{key:2,style:s([y.timeStyle]),class:"uni-countdown__number"},{default:n((()=>[i(u(p.h),1)])),_:1},8,["style"])):a("",!0),c.showHour?(e(),o(f,{key:3,style:s([y.splitorStyle]),class:"uni-countdown__splitor"},{default:n((()=>[i(u(c.showColon?":":y.hourText),1)])),_:1},8,["style"])):a("",!0),c.showMinute?(e(),o(f,{key:4,style:s([y.timeStyle]),class:"uni-countdown__number"},{default:n((()=>[i(u(p.i),1)])),_:1},8,["style"])):a("",!0),c.showMinute?(e(),o(f,{key:5,style:s([y.splitorStyle]),class:"uni-countdown__splitor"},{default:n((()=>[i(u(c.showColon?":":y.minuteText),1)])),_:1},8,["style"])):a("",!0),l(f,{style:s([y.timeStyle]),class:"uni-countdown__number"},{default:n((()=>[i(u(p.s),1)])),_:1},8,["style"]),c.showColon?a("",!0):(e(),o(f,{key:6,style:s([y.splitorStyle]),class:"uni-countdown__splitor"},{default:n((()=>[i(u(y.secondText),1)])),_:1},8,["style"]))])),_:1})}],["__scopeId","data-v-753d5db2"]]);const g=y({components:{},data:()=>({testHour:1,testMinute:0,testSecond:0,start:!1,timeupSecond:10}),mounted(){setTimeout((()=>{this.testHour=1,this.testMinute=1,this.testSecond=0,this.start=!0}),3e3),setTimeout((()=>{this.start=!1}),1e4)},methods:{timeup(){h({title:"时间到"}),this.timeupSecond=29}}},[["render",function(t,s,u,a,h,y){const w=d,S=p(c("uni-card"),m),g=p(c("uni-countdown"),_),F=p(c("uni-section"),f),b=r;return e(),o(b,{class:"container"},{default:n((()=>[l(S,{"is-full":""},{default:n((()=>[l(w,{class:"uni-h6"},{default:n((()=>[i("倒计时组件主要用于促销商品剩余时间，发送短信验证等待时间等场景")])),_:1})])),_:1}),l(F,{title:"一般用法",type:"line",padding:""},{default:n((()=>[l(g,{day:1,hour:1,minute:12,second:40})])),_:1}),l(F,{title:"不显示天数",subTitle:"设置 show-day = false 不显示天",type:"line",padding:""},{default:n((()=>[l(g,{"show-day":!1,hour:12,minute:12,second:12})])),_:1}),l(F,{title:"文字分隔符",subTitle:"设置 show-colon 属性设置分隔符样式",type:"line",padding:""},{default:n((()=>[l(g,{minute:30,second:0,"show-colon":!1})])),_:1}),l(F,{title:"修改颜色",subTitle:"设置 color \\ background 属性设置组件颜色",type:"line",padding:""},{default:n((()=>[l(g,{day:1,hour:2,minute:30,second:0,color:"#FFFFFF","background-color":"#007AFF"})])),_:1}),l(F,{title:"修改字体大小",subTitle:"设置 font-size 属性设置组件大小",type:"line",padding:""},{default:n((()=>[l(g,{"font-size":30,day:1,hour:2,minute:30,second:0})])),_:1}),l(F,{title:"修改颜色 + 字体大小",type:"line",padding:""},{default:n((()=>[l(g,{"font-size":30,day:1,hour:2,minute:30,second:0,color:"#FFFFFF","background-color":"#007AFF"})])),_:1}),l(F,{title:"自由控制开始/暂停",subTitle:"设置 start 属性控制是否自动开启",type:"line",padding:""},{default:n((()=>[l(g,{start:h.start,day:1,hour:1,minute:12,second:40},null,8,["start"])])),_:1}),l(F,{title:"倒计时回调事件",type:"line",padding:""},{default:n((()=>[l(g,{"show-day":!1,second:h.timeupSecond,onTimeup:y.timeup},null,8,["second","onTimeup"])])),_:1}),l(F,{title:"动态赋值",type:"line",padding:""},{default:n((()=>[l(g,{"show-day":!1,hour:h.testHour,minute:h.testMinute,second:h.testSecond},null,8,["hour","minute","second"])])),_:1})])),_:1})}]]);export{g as default};
