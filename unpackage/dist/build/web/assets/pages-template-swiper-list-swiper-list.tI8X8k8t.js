import{o as t,p as i,q as a,s,j as e,t as n,y as d,A as h,ap as l,Z as r,d as o,f as c,F as b,n as p,i as f,_ as u,a0 as L,$ as T}from"./index-DQotwNSd.js";import{_ as w}from"./_plugin-vue_export-helper.BCo6x5W8.js";const g=w({components:{swiperPage:w({props:{pid:{type:[Number,String],default:""}},data:()=>({dataList:[]}),created(){},methods:{loadData(){},clear(){this.dataList.length=0}}},[["render",function(l,r,o,c,b,p){const f=d,u=h;return t(),i(u,{class:"uni-swiper-page"},{default:a((()=>[s(f,null,{default:a((()=>[e("Tab View "+n(o.pid),1)])),_:1})])),_:1})}],["__scopeId","data-v-7a264e2a"]])},data:()=>({tabList:[],tabIndex:0,cacheTab:[],scrollInto:"",indicatorLineLeft:0,indicatorLineWidth:0,isTap:!1}),onLoad(){for(var t=0;t<6;t++)this.tabList.push({id:"tab"+t,name:"Tab "+(t+1),pageid:t+1})},onReady(){this._lastTabIndex=0,this.swiperWidth=0,this.tabbarWidth=0,this.tabListSize={},this._touchTabIndex=0,this.pageList=this.$refs.page,this.switchTab(this.tabIndex),this.getTabbarItemsSize()},methods:{ontabtap(t){let i=t.target.dataset.current||t.currentTarget.dataset.current;this.isTap=!0;var a=this.tabListSize[i];this.updateIndicator(a.left,a.width),this._touchTabIndex=i,this.switchTab(i)},onswiperchange(t){},onswiperscroll(t){if(!this.isTap){var i=t.detail.dx,a=this._lastTabIndex;if(i>1?a++:i<-1&&a--,!(a===this._lastTabIndex||a<0||a>this.pageList.length-1)){0===this.pageList[a].dataList.length&&this.loadTabData(a);var s=Math.abs(this.swiperWidth/i),e=this.tabListSize[this._lastTabIndex],n=this.tabListSize[a],d=e.left+(n.left-e.left)/s,h=e.width+(n.width-e.width)/s;this.updateIndicator(d,h)}}},animationfinish(t){let i=t.detail.current;this._touchTabIndex===i&&(this.isTap=!1),this._lastTabIndex=i,this.switchTab(i),this.updateIndicator(this.tabListSize[i].left,this.tabListSize[i].width)},getTabbarItemsSize(){l().in(this).select(".tab-view").fields({dataset:!0,size:!0},(t=>{this.swiperWidth=t.width})).exec(),l().in(this).selectAll(".uni-tab-item").boundingClientRect((t=>{t.forEach((t=>{this.tabListSize[t.dataset.id]=t}))})).exec(),setTimeout((()=>{this.updateIndicator(this.tabListSize[this.tabIndex].left,this.tabListSize[this.tabIndex].width)}),100)},updateIndicator(t,i){this.indicatorLineLeft=t,this.indicatorLineWidth=i},switchTab(t){if(0===this.pageList[t].dataList.length&&this.loadTabData(t),this.tabIndex!==t){if(this.pageList[this.tabIndex].dataList.length>100){this.cacheTab.indexOf(this.tabIndex)<0&&this.cacheTab.push(this.tabIndex)}if(this.tabIndex=t,this.scrollInto=this.tabList[t].id,this.cacheTab.length>3){let t=this.cacheTab[0];this.clearTabData(t),this.cacheTab.splice(0,1)}}},scrollTabTo(t){const i=this.$refs["tabitem"+t][0];let a=0;t>0&&(a=this.tabbarWidth/2-this.tabListSize[t].width/2,this.tabListSize[t].right<this.tabbarWidth/2&&(a=this.tabListSize[0].width)),dom.scrollToElement(i,{offset:-a})},loadTabData(t){this.pageList[t].loadData()},clearTabData(t){this.pageList[t].clear()}}},[["render",function(l,w,g,x,m,I){const _=d,v=h,z=u,S=r("swiperPage"),y=T,W=L;return t(),i(v,{class:"tabs"},{default:a((()=>[s(z,{ref:"tabbar1",id:"tab-bar",class:"tab-bar",scroll:!1,"scroll-x":!0,"show-scrollbar":!1,"scroll-into-view":m.scrollInto},{default:a((()=>[s(v,{style:{"flex-direction":"column"}},{default:a((()=>[s(v,{style:{"flex-direction":"row"}},{default:a((()=>[(t(!0),o(b,null,c(m.tabList,((d,h)=>(t(),i(v,{class:"uni-tab-item",key:d.id,id:d.id,ref_for:!0,ref:"tabitem"+h,"data-id":h,"data-current":h,onClick:I.ontabtap},{default:a((()=>[s(_,{class:p(["uni-tab-item-title",m.tabIndex==h?"uni-tab-item-title-active":""])},{default:a((()=>[e(n(d.name),1)])),_:2},1032,["class"])])),_:2},1032,["id","data-id","data-current","onClick"])))),128))])),_:1}),s(v,{class:"scroll-view-indicator"},{default:a((()=>[s(v,{ref:"underline",class:p(["scroll-view-underline",m.isTap?"scroll-view-animation":""]),style:f({left:m.indicatorLineLeft+"px",width:m.indicatorLineWidth+"px"})},null,8,["class","style"])])),_:1})])),_:1})])),_:1},8,["scroll-into-view"]),s(v,{class:"tab-bar-line"}),s(W,{class:"tab-view",ref:"swiper1",id:"tab-bar-view",current:m.tabIndex,duration:300,onChange:I.onswiperchange,onTransition:I.onswiperscroll,onAnimationfinish:I.animationfinish,onOnAnimationEnd:I.animationfinish},{default:a((()=>[(t(!0),o(b,null,c(m.tabList,((e,n)=>(t(),i(y,{class:"swiper-item",key:n},{default:a((()=>[s(S,{class:"swiper-page",pid:e.pageid,ref_for:!0,ref:"page"},null,8,["pid"])])),_:2},1024)))),128))])),_:1},8,["current","onChange","onTransition","onAnimationfinish","onOnAnimationEnd"])])),_:1})}],["__scopeId","data-v-9c75e85b"]]);export{g as default};
