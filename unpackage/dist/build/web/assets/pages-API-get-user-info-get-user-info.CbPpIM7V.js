import{B as e,ay as s,ax as n,P as t,m as a,p as o,q as r,A as i,o as l,s as f,j as u,h as c,d,t as h,F as I,y as g,x as p,K as m}from"./index-DQotwNSd.js";import{_ as U}from"./page-head.CAicG8M0.js";import{r as _}from"./uni-app.es.Dfk47BXh.js";import{_ as v}from"./_plugin-vue_export-helper.BCo6x5W8.js";const b=v({data:()=>({title:"getUserInfo",hasUserInfo:!1,userInfo:{},btnLoading:!1}),computed:{...e(["loginProvider","isUniverifyLogin"])},methods:{...s(["getPhoneNumber"]),getUserInfo(){if(this.btnLoading=!0,this.isUniverifyLogin)this.getPhoneNumber(n("univerifyInfo")).then((e=>{this.hasUserInfo=!0,this.userInfo={phoneNumber:e}})).catch((e=>{console.error("getUserInfo fail:",e),this.hasUserInfo=!1})).finally((()=>{this.btnLoading=!1}));else{if("apple"===this.loginProvider){const e=n("apple_nickname");if(e)return this.hasUserInfo=!0,this.userInfo={nickName:e},void(this.btnLoading=!1)}uni.getUserInfo({provider:this.loginProvider,success:e=>{this.hasUserInfo=!0,this.userInfo=e.userInfo},fail:e=>{console.log("getUserInfo fail",e);let s=e.errMsg;~s.indexOf("uni.login")&&(s="请在登录页面完成登录操作"),uni.getSetting({success:e=>{let n=e.authSetting["scope.userInfo"];t(n?{title:"获取用户信息失败",content:"错误原因"+s,showCancel:!1}:{title:"授权失败",content:"Hello uni-app需要获取您的用户信息，请在设置界面打开相关权限",success:e=>{e.confirm&&uni.openSetting()}})}})},complete:()=>{this.btnLoading=!1}})}},mpGetUserInfo(e){console.log("mpGetUserInfo",e),"getUserInfo:ok"===e.detail.errMsg?(this.hasUserInfo=!0,e.detail&&e.detail.userInfo&&(this.userInfo=e.detail.userInfo)):t({title:"获取用户信息失败",content:"错误原因"+e.detail.errMsg,showCancel:!1})},clear(){this.hasUserInfo=!1,this.userInfo={}}}},[["render",function(e,s,n,t,v,b){const y=_(a("page-head"),U),k=g,x=i,L=p,N=m;return l(),o(x,null,{default:r((()=>[f(y,{title:v.title},null,8,["title"]),f(x,{class:"uni-padding-wrap"},{default:r((()=>[f(x,{style:{background:"#FFF",padding:"40rpx"}},{default:r((()=>[!1===v.hasUserInfo?(l(),o(x,{key:0,class:"uni-hello-text uni-center"},{default:r((()=>[f(k,null,{default:r((()=>[u("请点击下方按钮获取用户头像及昵称或手机号")])),_:1})])),_:1})):c("",!0),!0===v.hasUserInfo?(l(),d(I,{key:1},[f(x,{class:"uni-h4 uni-center uni-common-mt"},{default:r((()=>[u(h(v.userInfo.nickName||v.userInfo.nickname||v.userInfo.gender||v.userInfo.email||v.userInfo.phoneNumber),1)])),_:1}),v.userInfo.avatarUrl||v.userInfo.avatar_url?(l(),o(x,{key:0,style:{padding:"30rpx 0","text-align":"center"}},{default:r((()=>[f(L,{class:"userinfo-avatar",src:v.userInfo.avatarUrl||v.userInfo.avatar_url},null,8,["src"])])),_:1})):c("",!0)],64)):c("",!0)])),_:1}),f(x,{class:"uni-btn-v"},{default:r((()=>[f(N,{onClick:b.clear},{default:r((()=>[u("清空")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-3bce0985"]]);export{b as default};
