{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\后台\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Administrator\\Desktop\\后台\\src\\utils\\crypto.js","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\后台\\src\\utils\\crypto.js","mtime":1752285830423},{"path":"C:\\Users\\Administrator\\Desktop\\后台\\babel.config.js","mtime":1592918105000},{"path":"C:\\Users\\Administrator\\Desktop\\后台\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\后台\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5qc29uLnN0cmluZ2lmeS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmcuanMiOwppbXBvcnQgSlNFbmNyeXB0IGZyb20gJ2pzZW5jcnlwdCc7CmltcG9ydCBDcnlwdG9KUyBmcm9tICdjcnlwdG8tanMnOwoKLy8gUlNB5Yqg5a+GCmV4cG9ydCBmdW5jdGlvbiByc2FFbmNyeXB0KGRhdGEsIHB1YmxpY0tleSkgewogIHZhciBlbmNyeXB0b3IgPSBuZXcgSlNFbmNyeXB0KCk7CiAgZW5jcnlwdG9yLnNldFB1YmxpY0tleShwdWJsaWNLZXkpOwogIHJldHVybiBlbmNyeXB0b3IuZW5jcnlwdChkYXRhKTsKfQpleHBvcnQgZnVuY3Rpb24gYWVzRW5jcnlwdChkYXRhLCBrZXkpIHsKICAvLyDlsIZCYXNlNjTlr4bpkqXovazmjaLkuLpXb3JkQXJyYXkKICB2YXIga2V5V0EgPSBDcnlwdG9KUy5lbmMuQmFzZTY0LnBhcnNlKGtleSk7CiAgdmFyIGl2ID0gQ3J5cHRvSlMubGliLldvcmRBcnJheS5yYW5kb20oMTYpOwogIHZhciBlbmNyeXB0ZWQgPSBDcnlwdG9KUy5BRVMuZW5jcnlwdChKU09OLnN0cmluZ2lmeShkYXRhKSwga2V5V0EsCiAgLy8g5L2/55So6Kej5p6Q5ZCO55qE5a+G6ZKlCiAgewogICAgaXY6IGl2LAogICAgbW9kZTogQ3J5cHRvSlMubW9kZS5DQkMsCiAgICBwYWRkaW5nOiBDcnlwdG9KUy5wYWQuUGtjczcKICB9KTsKICB2YXIgY29tYmluZWQgPSBpdi5jb25jYXQoZW5jcnlwdGVkLmNpcGhlcnRleHQpOwogIHJldHVybiBjb21iaW5lZC50b1N0cmluZyhDcnlwdG9KUy5lbmMuQmFzZTY0KTsKfQpleHBvcnQgZnVuY3Rpb24gYWVzRGVjcnlwdChjaXBoZXJ0ZXh0LCBrZXkpIHsKICB2YXIga2V5V0EgPSBDcnlwdG9KUy5lbmMuQmFzZTY0LnBhcnNlKGtleSk7CiAgdmFyIHJhd0RhdGEgPSBDcnlwdG9KUy5lbmMuQmFzZTY0LnBhcnNlKGNpcGhlcnRleHQpOwogIHZhciBpdiA9IENyeXB0b0pTLmxpYi5Xb3JkQXJyYXkuY3JlYXRlKHJhd0RhdGEud29yZHMuc2xpY2UoMCwgNCksIDE2KTsKICB2YXIgY2lwaGVydGV4dFdBID0gQ3J5cHRvSlMubGliLldvcmRBcnJheS5jcmVhdGUocmF3RGF0YS53b3Jkcy5zbGljZSg0KSwgcmF3RGF0YS5zaWdCeXRlcyAtIDE2KTsKICB2YXIgZGVjcnlwdGVkID0gQ3J5cHRvSlMuQUVTLmRlY3J5cHQoewogICAgY2lwaGVydGV4dDogY2lwaGVydGV4dFdBCiAgfSwga2V5V0EsCiAgLy8g5L2/55So6Kej5p6Q5ZCO55qE5a+G6ZKlCiAgewogICAgaXY6IGl2LAogICAgbW9kZTogQ3J5cHRvSlMubW9kZS5DQkMsCiAgICBwYWRkaW5nOiBDcnlwdG9KUy5wYWQuUGtjczcKICB9KTsKICByZXR1cm4gSlNPTi5wYXJzZShkZWNyeXB0ZWQudG9TdHJpbmcoQ3J5cHRvSlMuZW5jLlV0ZjgpKTsKfQpleHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVBZXNLZXkoKSB7CiAgcmV0dXJuIENyeXB0b0pTLmVuYy5CYXNlNjQuc3RyaW5naWZ5KENyeXB0b0pTLmxpYi5Xb3JkQXJyYXkucmFuZG9tKDMyKSk7Cn0="},{"version":3,"names":["JSEncrypt","CryptoJS","rsaEncrypt","data","publicKey","encryptor","setPublicKey","encrypt","aesEncrypt","key","keyWA","enc","Base64","parse","iv","lib","WordArray","random","encrypted","AES","JSON","stringify","mode","CBC","padding","pad","Pkcs7","combined","concat","ciphertext","toString","aesDecrypt","rawData","create","words","slice","ciphertextWA","sigBytes","decrypted","decrypt","Utf8","generateAesKey"],"sources":["C:/Users/Administrator/Desktop/后台/src/utils/crypto.js"],"sourcesContent":["import JSEncrypt from 'jsencrypt'\nimport CryptoJS from 'crypto-js'\n\n// RSA加密\nexport function rsaEncrypt(data, publicKey) {\n  const encryptor = new JSEncrypt()\n  encryptor.setPublicKey(publicKey)\n  return encryptor.encrypt(data)\n}\n\nexport function aesEncrypt(data, key) {\n  // 将Base64密钥转换为WordArray\n  const keyWA = CryptoJS.enc.Base64.parse(key)\n  const iv = CryptoJS.lib.WordArray.random(16)\n\n  const encrypted = CryptoJS.AES.encrypt(\n    JSON.stringify(data),\n    keyWA, // 使用解析后的密钥\n    {\n      iv: iv,\n      mode: CryptoJS.mode.CBC,\n      padding: CryptoJS.pad.Pkcs7\n    }\n  )\n\n  const combined = iv.concat(encrypted.ciphertext)\n  return combined.toString(CryptoJS.enc.Base64)\n}\n\nexport function aesDecrypt(ciphertext, key) {\n  const keyWA = CryptoJS.enc.Base64.parse(key)\n\n  const rawData = CryptoJS.enc.Base64.parse(ciphertext)\n  const iv = CryptoJS.lib.WordArray.create(rawData.words.slice(0, 4), 16)\n  const ciphertextWA = CryptoJS.lib.WordArray.create(\n    rawData.words.slice(4),\n    rawData.sigBytes - 16\n  )\n\n  const decrypted = CryptoJS.AES.decrypt(\n    { ciphertext: ciphertextWA },\n    keyWA, // 使用解析后的密钥\n    {\n      iv: iv,\n      mode: CryptoJS.mode.CBC,\n      padding: CryptoJS.pad.Pkcs7\n    }\n  )\n\n  return JSON.parse(decrypted.toString(CryptoJS.enc.Utf8))\n}\n\nexport function generateAesKey() {\n  return CryptoJS.enc.Base64.stringify(CryptoJS.lib.WordArray.random(32))\n}\n\n"],"mappings":";;;;;;AAAA,OAAOA,SAAS,MAAM,WAAW;AACjC,OAAOC,QAAQ,MAAM,WAAW;;AAEhC;AACA,OAAO,SAASC,UAAUA,CAACC,IAAI,EAAEC,SAAS,EAAE;EAC1C,IAAMC,SAAS,GAAG,IAAIL,SAAS,CAAC,CAAC;EACjCK,SAAS,CAACC,YAAY,CAACF,SAAS,CAAC;EACjC,OAAOC,SAAS,CAACE,OAAO,CAACJ,IAAI,CAAC;AAChC;AAEA,OAAO,SAASK,UAAUA,CAACL,IAAI,EAAEM,GAAG,EAAE;EACpC;EACA,IAAMC,KAAK,GAAGT,QAAQ,CAACU,GAAG,CAACC,MAAM,CAACC,KAAK,CAACJ,GAAG,CAAC;EAC5C,IAAMK,EAAE,GAAGb,QAAQ,CAACc,GAAG,CAACC,SAAS,CAACC,MAAM,CAAC,EAAE,CAAC;EAE5C,IAAMC,SAAS,GAAGjB,QAAQ,CAACkB,GAAG,CAACZ,OAAO,CACpCa,IAAI,CAACC,SAAS,CAAClB,IAAI,CAAC,EACpBO,KAAK;EAAE;EACP;IACEI,EAAE,EAAEA,EAAE;IACNQ,IAAI,EAAErB,QAAQ,CAACqB,IAAI,CAACC,GAAG;IACvBC,OAAO,EAAEvB,QAAQ,CAACwB,GAAG,CAACC;EACxB,CACF,CAAC;EAED,IAAMC,QAAQ,GAAGb,EAAE,CAACc,MAAM,CAACV,SAAS,CAACW,UAAU,CAAC;EAChD,OAAOF,QAAQ,CAACG,QAAQ,CAAC7B,QAAQ,CAACU,GAAG,CAACC,MAAM,CAAC;AAC/C;AAEA,OAAO,SAASmB,UAAUA,CAACF,UAAU,EAAEpB,GAAG,EAAE;EAC1C,IAAMC,KAAK,GAAGT,QAAQ,CAACU,GAAG,CAACC,MAAM,CAACC,KAAK,CAACJ,GAAG,CAAC;EAE5C,IAAMuB,OAAO,GAAG/B,QAAQ,CAACU,GAAG,CAACC,MAAM,CAACC,KAAK,CAACgB,UAAU,CAAC;EACrD,IAAMf,EAAE,GAAGb,QAAQ,CAACc,GAAG,CAACC,SAAS,CAACiB,MAAM,CAACD,OAAO,CAACE,KAAK,CAACC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC;EACvE,IAAMC,YAAY,GAAGnC,QAAQ,CAACc,GAAG,CAACC,SAAS,CAACiB,MAAM,CAChDD,OAAO,CAACE,KAAK,CAACC,KAAK,CAAC,CAAC,CAAC,EACtBH,OAAO,CAACK,QAAQ,GAAG,EACrB,CAAC;EAED,IAAMC,SAAS,GAAGrC,QAAQ,CAACkB,GAAG,CAACoB,OAAO,CACpC;IAAEV,UAAU,EAAEO;EAAa,CAAC,EAC5B1B,KAAK;EAAE;EACP;IACEI,EAAE,EAAEA,EAAE;IACNQ,IAAI,EAAErB,QAAQ,CAACqB,IAAI,CAACC,GAAG;IACvBC,OAAO,EAAEvB,QAAQ,CAACwB,GAAG,CAACC;EACxB,CACF,CAAC;EAED,OAAON,IAAI,CAACP,KAAK,CAACyB,SAAS,CAACR,QAAQ,CAAC7B,QAAQ,CAACU,GAAG,CAAC6B,IAAI,CAAC,CAAC;AAC1D;AAEA,OAAO,SAASC,cAAcA,CAAA,EAAG;EAC/B,OAAOxC,QAAQ,CAACU,GAAG,CAACC,MAAM,CAACS,SAAS,CAACpB,QAAQ,CAACc,GAAG,CAACC,SAAS,CAACC,MAAM,CAAC,EAAE,CAAC,CAAC;AACzE","ignoreList":[]}]}