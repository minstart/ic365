{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\后台\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Administrator\\Desktop\\后台\\src\\permission.js","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\后台\\src\\permission.js","mtime":1751538493518},{"path":"C:\\Users\\Administrator\\Desktop\\后台\\babel.config.js","mtime":1592918105000},{"path":"C:\\Users\\Administrator\\Desktop\\后台\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\后台\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvciBmcm9tICJDOi9Vc2Vycy9BZG1pbmlzdHJhdG9yL0Rlc2t0b3AvXHU1NDBFXHU1M0YwL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9yZWdlbmVyYXRvci5qcyI7CmltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gIkM6L1VzZXJzL0FkbWluaXN0cmF0b3IvRGVza3RvcC9cdTU0MEVcdTUzRjAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQzovVXNlcnMvQWRtaW5pc3RyYXRvci9EZXNrdG9wL1x1NTQwRVx1NTNGMC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvci5qcyI7CmltcG9ydCByb3V0ZXIgZnJvbSAnLi9yb3V0ZXInOwppbXBvcnQgc3RvcmUgZnJvbSAnLi9zdG9yZSc7CmltcG9ydCB7IE1lc3NhZ2UgfSBmcm9tICdlbGVtZW50LXVpJzsKaW1wb3J0IE5Qcm9ncmVzcyBmcm9tICducHJvZ3Jlc3MnOyAvLyBwcm9ncmVzcyBiYXIKaW1wb3J0ICducHJvZ3Jlc3MvbnByb2dyZXNzLmNzcyc7IC8vIHByb2dyZXNzIGJhciBzdHlsZQppbXBvcnQgeyBnZXRUb2tlbiB9IGZyb20gJ0AvdXRpbHMvYXV0aCc7IC8vIGdldCB0b2tlbiBmcm9tIGNvb2tpZQppbXBvcnQgZ2V0UGFnZVRpdGxlIGZyb20gJ0AvdXRpbHMvZ2V0LXBhZ2UtdGl0bGUnOwpOUHJvZ3Jlc3MuY29uZmlndXJlKHsKICBzaG93U3Bpbm5lcjogZmFsc2UKfSk7CnZhciB3aGl0ZUxpc3QgPSBbJy9sb2dpbiddOwpyb3V0ZXIuYmVmb3JlRWFjaCgvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoLyojX19QVVJFX18qL19yZWdlbmVyYXRvcigpLm0oZnVuY3Rpb24gX2NhbGxlZSh0bywgZnJvbSwgbmV4dCkgewogICAgdmFyIGhhc1Rva2VuLCBoYXNSb2xlcywgaW5mbywgYWNjZXNzUm91dGVzLCBfdDsKICAgIHJldHVybiBfcmVnZW5lcmF0b3IoKS53KGZ1bmN0aW9uIChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dC5uKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgTlByb2dyZXNzLnN0YXJ0KCk7CgogICAgICAgICAgLy8gc2V0IHBhZ2UgdGl0bGUKICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gZ2V0UGFnZVRpdGxlKHRvLm1ldGEudGl0bGUpOwoKICAgICAgICAgIC8vIGRldGVybWluZSB3aGV0aGVyIHRoZSB1c2VyIGhhcyBsb2dnZWQgaW4KICAgICAgICAgIGhhc1Rva2VuID0gZ2V0VG9rZW4oKTsKICAgICAgICAgIGlmICghaGFzVG9rZW4pIHsKICAgICAgICAgICAgX2NvbnRleHQubiA9IDg7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgICAgaWYgKCEodG8ucGF0aCA9PT0gJy9sb2dpbicpKSB7CiAgICAgICAgICAgIF9jb250ZXh0Lm4gPSAxOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIG5leHQoewogICAgICAgICAgICBwYXRoOiAnLycKICAgICAgICAgIH0pOwogICAgICAgICAgTlByb2dyZXNzLmRvbmUoKTsKICAgICAgICAgIF9jb250ZXh0Lm4gPSA3OwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgaGFzUm9sZXMgPSBzdG9yZS5nZXR0ZXJzLnJvbGVzICYmIHN0b3JlLmdldHRlcnMucm9sZXMubGVuZ3RoID4gMDsKICAgICAgICAgIGlmICghaGFzUm9sZXMpIHsKICAgICAgICAgICAgX2NvbnRleHQubiA9IDI7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgICAgbmV4dCgpOwogICAgICAgICAgX2NvbnRleHQubiA9IDc7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICBfY29udGV4dC5wID0gMjsKICAgICAgICAgIF9jb250ZXh0Lm4gPSAzOwogICAgICAgICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCd1c2VyL2dldEluZm8nKTsKICAgICAgICBjYXNlIDM6CiAgICAgICAgICBpbmZvID0gX2NvbnRleHQudjsKICAgICAgICAgIC8vIOiOt+WPlueUqOaIt+iPnOWNlQogICAgICAgICAgLy8gY29uc3QgbWVudXMgPSBhd2FpdCBzdG9yZS5kaXNwYXRjaCgndXNlci9nZXRNZW51RnJvbVNlcnZlcicsIHt9LCB7cm9vdCA6IHRydWV9KQogICAgICAgICAgLy8gY29uc29sZS5sb2coJ1JlY2VpdmVkIG1lbnVzOicsIEpTT04uc3RyaW5naWZ5KG1lbnVzLCBudWxsLCAyKSkgLy8g5omT5Y2w6I+c5Y2V5pWw5o2uCgogICAgICAgICAgY29uc29sZS5sb2coJ2luZm8nLCBpbmZvKTsKICAgICAgICAgIF9jb250ZXh0Lm4gPSA0OwogICAgICAgICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCdwZXJtaXNzaW9uL2dlbmVyYXRlUm91dGVzJywgaW5mby5yb2xlcyk7CiAgICAgICAgY2FzZSA0OgogICAgICAgICAgYWNjZXNzUm91dGVzID0gX2NvbnRleHQudjsKICAgICAgICAgIC8vIOeUn+aIkOWKqOaAgei3r+eUsQogICAgICAgICAgLy8gY29uc3QgYWNjZXNzUm91dGVzID0gYXdhaXQgc3RvcmUuZGlzcGF0Y2goJ3Blcm1pc3Npb24vZ2VuZXJhdGVSb3V0ZXMnLCBtZW51cykKICAgICAgICAgIGNvbnNvbGUubG9nKCdHZW5lcmF0ZWQgcm91dGVzOicsIGFjY2Vzc1JvdXRlcyk7IC8vIOaJk+WNsOeUn+aIkOeahOi3r+eUsQoKICAgICAgICAgIC8vIOWKqOaAgea3u+WKoOi3r+eUsQogICAgICAgICAgcm91dGVyLmFkZFJvdXRlcyhhY2Nlc3NSb3V0ZXMpOwogICAgICAgICAgbmV4dChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHRvKSwge30sIHsKICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZQogICAgICAgICAgfSkpOwogICAgICAgICAgX2NvbnRleHQubiA9IDc7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDU6CiAgICAgICAgICBfY29udGV4dC5wID0gNTsKICAgICAgICAgIF90ID0gX2NvbnRleHQudjsKICAgICAgICAgIF9jb250ZXh0Lm4gPSA2OwogICAgICAgICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCd1c2VyL3Jlc2V0VG9rZW4nKTsKICAgICAgICBjYXNlIDY6CiAgICAgICAgICBNZXNzYWdlLmVycm9yKF90IHx8ICdIYXMgRXJyb3InKTsKICAgICAgICAgIG5leHQoIi9sb2dpbj9yZWRpcmVjdD0iLmNvbmNhdCh0by5wYXRoKSk7CiAgICAgICAgICBOUHJvZ3Jlc3MuZG9uZSgpOwogICAgICAgIGNhc2UgNzoKICAgICAgICAgIF9jb250ZXh0Lm4gPSA5OwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA4OgogICAgICAgICAgLyogaGFzIG5vIHRva2VuKi8KCiAgICAgICAgICBpZiAod2hpdGVMaXN0LmluZGV4T2YodG8ucGF0aCkgIT09IC0xKSB7CiAgICAgICAgICAgIC8vIGluIHRoZSBmcmVlIGxvZ2luIHdoaXRlbGlzdCwgZ28gZGlyZWN0bHkKICAgICAgICAgICAgbmV4dCgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV4dCgiL2xvZ2luP3JlZGlyZWN0PSIuY29uY2F0KHRvLnBhdGgpKTsKICAgICAgICAgICAgTlByb2dyZXNzLmRvbmUoKTsKICAgICAgICAgIH0KICAgICAgICBjYXNlIDk6CiAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYSgyKTsKICAgICAgfQogICAgfSwgX2NhbGxlZSwgbnVsbCwgW1syLCA1XV0pOwogIH0pKTsKICByZXR1cm4gZnVuY3Rpb24gKF94LCBfeDIsIF94MykgewogICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCkpOwpyb3V0ZXIuYWZ0ZXJFYWNoKGZ1bmN0aW9uICgpIHsKICBOUHJvZ3Jlc3MuZG9uZSgpOwp9KTs="},{"version":3,"names":["router","store","Message","NProgress","getToken","getPageTitle","configure","showSpinner","whiteList","beforeEach","_ref","_asyncToGenerator","_regenerator","m","_callee","to","from","next","hasToken","hasRoles","info","accessRoutes","_t","w","_context","n","start","document","title","meta","path","done","getters","roles","length","p","dispatch","v","console","log","addRoutes","_objectSpread","replace","error","concat","indexOf","a","_x","_x2","_x3","apply","arguments","afterEach"],"sources":["C:/Users/Administrator/Desktop/后台/src/permission.js"],"sourcesContent":["import router from './router'\nimport store from './store'\nimport { Message } from 'element-ui'\nimport NProgress from 'nprogress' // progress bar\nimport 'nprogress/nprogress.css' // progress bar style\nimport { getToken } from '@/utils/auth' // get token from cookie\nimport getPageTitle from '@/utils/get-page-title'\n\nNProgress.configure({ showSpinner: false })\n\nconst whiteList = ['/login']\n\nrouter.beforeEach(async(to, from, next) => {\n  NProgress.start()\n\n  // set page title\n  document.title = getPageTitle(to.meta.title)\n\n  // determine whether the user has logged in\n  const hasToken = getToken()\n\n  if (hasToken) {\n    if (to.path === '/login') {\n      next({ path: '/' })\n      NProgress.done()\n    } else {\n      const hasRoles = store.getters.roles && store.getters.roles.length > 0\n      if (hasRoles) {\n        next()\n      } else {\n        try {\n          // 获取用户信息\n          const info = await store.dispatch('user/getInfo')\n\n          // 获取用户菜单\n          // const menus = await store.dispatch('user/getMenuFromServer', {}, {root : true})\n          // console.log('Received menus:', JSON.stringify(menus, null, 2)) // 打印菜单数据\n\n          console.log('info', info)\n          const accessRoutes = await store.dispatch('permission/generateRoutes', info.roles)\n\n          // 生成动态路由\n          // const accessRoutes = await store.dispatch('permission/generateRoutes', menus)\n          console.log('Generated routes:', accessRoutes) // 打印生成的路由\n\n          // 动态添加路由\n          router.addRoutes(accessRoutes)\n\n          next({ ...to, replace: true })\n        } catch (error) {\n          await store.dispatch('user/resetToken')\n          Message.error(error || 'Has Error')\n          next(`/login?redirect=${to.path}`)\n          NProgress.done()\n        }\n      }\n    }\n  } else {\n    /* has no token*/\n\n    if (whiteList.indexOf(to.path) !== -1) {\n      // in the free login whitelist, go directly\n      next()\n    } else {\n      next(`/login?redirect=${to.path}`)\n      NProgress.done()\n    }\n  }\n})\n\nrouter.afterEach(() => {\n  NProgress.done()\n})\n"],"mappings":"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","ignoreList":[]}]}